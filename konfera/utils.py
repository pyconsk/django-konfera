from konfera.models.order import Order
from konfera.settings import GOOGLE_ANALYTICS


def collect_view_data(request):
    """
    Function collects view_data generated by other functions
    """
    view_data = dict()

    if GOOGLE_ANALYTICS:
        view_data['ga'] = GOOGLE_ANALYTICS

    return view_data


def update_order_status_context(status, context):
    if status == Order.PAID:
        context['status_label'] = 'label-success'
    elif status in [Order.CANCELLED, Order.EXPIRED]:
        context['status_label'] = 'label-danger'
    else:
        context['status_label'] = 'label-warning'


def update_event_context(event, context, show_sponsors=True):
    context['event'] = event

    if show_sponsors:
        context['sponsors'] = event.sponsors.all().order_by('type', 'title')

    if event.analytics:
        context['ga'] = event.analytics

